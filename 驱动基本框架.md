# 驱动基本框架
#### 内核基本头文件  
`#include <linux/module.h>`  module--模块  
包含内核模块信息声明的相关函数  

`#include <linux/init.h>`  
包含了module_init()和module_exit()函数声明 

`#include <linux/kernel.h>`    kernel--内核  
包含内核提供的各种函数，如printk  
***
#### 修饰符
`__init`修饰初始化函数  
`__initdata`修饰初始化变量  
上述修饰符会将变量和函数放入初始化节点，在初始化阶段结束后就会释放掉。  

`__exit`修饰卸载函数  
`__exitdata`修饰卸载变量  
上述修饰符会将变量和函数放入卸载节点，当模块编入内核(不会使用卸载功能)时，会将其无视，不进行编入。  
***
#### 驱动模块加载和卸载
`Module_init(函数：int(void))`  
`Module_exit(函数：void(void))`  
上述函数用于通知内核初始化或卸载模块的时候，要使用哪个函数进行初始化或卸载。  
默认初始化函数`int init_module(void)`  
默认卸载函数`void cleanup_module(void)`  
***
#### 打印函数
`printf`：glibc实现的打印函数，工作于用户空间  
`printk`：内核模块无法使用glibc库函数，内核自身实现的一个类printf函数，但是需要指定打印等级。  
`dmesg`----打印内核所有打印信息。注意内核log缓冲区大小有限制，缓冲区数据可能被覆盖掉。  
查看当前系统printk打印等级：`cat /proc/sys/kernel/printk`  
从左到右依次对应当前控制台日志级别、默认消息日志级别、最小的控制台级别、默认控制台日志级别。  
***
#### 地址映射函数
`ioremap(paddr(物理地址), size)`  
当映射成功后返回一段虚拟空间的起始地址，可以通过这段虚拟地址来实现实际物理地址的读写操作。  
便于多线程复用函数。  
`void iounmap(void *addr)`  
取消ioremap地址映射。addr为映射后的虚拟地址。
***
#### 相关信息声明(没有，无伤大雅)
`MODULE_LICENSE()`表示模块代码接收的软件许可协议  
`MODULE_AUTHOR()`描述模块作者的信息  
`MODULE_DESCRIPRION()`对模块的简单介绍  
`MODULE_ALIAS()`给模块设置一个别名  
***